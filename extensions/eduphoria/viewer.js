(()=>{"use strict";var e={2530:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEarlyExit=void 0;t.createEarlyExit=()=>{const e=document.createElement("iframe");e.src=chrome.runtime.getURL("early-exit.html"),e.style.position="fixed",e.style.zIndex="9999999999",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%)",e.style.border="none",e.style.width="602px",e.style.height="302px",e.id="earlyexitframe",document.body.appendChild(e);const t=(e,t,n)=>{"earlyexitsignalcheck"===e.action&&n({action:!0})},n=a=>{"removeldbearlyexit"===a.data&&(document.body.removeChild(e),window.removeEventListener("message",n),chrome.runtime.onMessage.removeListener(t))};chrome.runtime.onMessage.addListener(t),window.addEventListener("message",n)}},3982:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createToolbar=void 0;const a=n(7125);t.createToolbar=()=>{chrome.runtime.onMessage.addListener((e,t,n)=>{"toolbarsignalcheck"==e.action&&n("")}),chrome.storage.local.get("systemState",async e=>{const t=e.systemState;let n=(0,a.geti18nTranslations)(["exit_confirm","yes","no","proctor_password","enter","dismiss","incorrect_password","calculator","exam_link","link_blocked"]);var o;t.overrideLocale&&(n=await(0,a.getTranslations)(n,t.overrideLocale));const r=await chrome.runtime.sendMessage("gettabid"),s=t.examTabTitle,i=t.tabIds,l=t.examTabId,c=t.calculator>0,d=t.monitorTabId,y=t.recordingStarted,m=t.susOpen,p=document.createElement("div"),u="54px";p.id="ldbtoolbar",p.style.width="100%",p.style.backgroundColor="#4B4B4B",p.style.height=u,p.style.maxHeight=u,p.style.position="fixed",p.style.left="0px",p.style.top="0px",p.style.zIndex="9999999",p.style.display="flex";const g=document.createElement("ul");g.id="tablist",g.style.listStyleType="none",g.style.overflow="hidden",g.style.margin="0",g.style.padding="0";const h=(e,t,a,r,s)=>{const i=document.createElement("li");i.addEventListener("click",t=>{const n=t.currentTarget;"exit-tab"===t.target.id?chrome.runtime.sendMessage({action:"removetab",tabId:e}):n.id===e.toString()&&chrome.runtime.sendMessage({action:"activatetab",tabId:e})}),e?i.id=e.toString():chrome.runtime.sendMessage({action:"getTabId"},e=>{e.tabId&&(i.id=e.tabId)}),i.style.minWidth="175px",i.style.float="left",i.style.height="51px",i.style.textAlign="left",t===e?(i.style.backgroundColor="white",i.style.color="#4a4a4a"):(i.style.cursor="pointer",i.style.color="white"),t===a&&i.classList.add("exam-tab"),i.style.fontFamily="Arial",i.style.fontSize="medium",i.style.border="solid",i.style.borderColor="gray",i.style.borderWidth="1px",i.style.lineHeight="52px",i.style.userSelect="none";const l=document.createElement("span");t===s&&(o=l),l.id="tab-title",r?l.textContent=r:e===a?l.textContent="Exam":e===t&&location.ancestorOrigins[0]&&location.ancestorOrigins[0].includes("smc-service-cloud.respondus2.com")?l.textContent="Troubleshooter":e===t&&location.ancestorOrigins[0]&&location.ancestorOrigins[0].includes("respondus.knowledgeowl.com")?l.textContent="Knowledge Base":e===t&&window.location.origin.includes("paypal")?l.textContent="PayPal":l.textContent=n.exam_link,l.style.paddingLeft="16px",l.style.paddingRight="16px",i.appendChild(l);const c=document.createElement("button");return c.id="exit-tab",c.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/close-tab.png")}`,c.style.height="15px",c.style.float="right",c.style.marginTop="18px",c.style.marginRight="20px",c.style.marginLeft="10px",c.style.width="20px",c.style.backgroundColor="#4B4B4B",c.style.backgroundSize="cover",c.style.border="none",c.style.borderRadius="3px",c.style.cursor="pointer",a!==e&&i.appendChild(c),i};if((m||t.instructorLiveProctoring)&&d===r){let e="Pre Exam Checks";t.instructorLiveProctoring&&(e="Live Proctoring"),g.append(h(d,r,d,e,d))}else l&&g.append(h(l,r,l,s));if(i&&l)for(const e of i)g.appendChild(h(e,r,l));const b=document.createElement("div");b.style.position="absolute",b.style.right="0",b.style.display="flex",b.style.gap="26px",b.style.backgroundColor="#4B4B4B",b.style.height="54px",b.style.paddingLeft="5px";const w=document.createElement("button");w.addEventListener("click",e=>{chrome.runtime.sendMessage({action:"calculator"})}),w.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/calculator-light.png")}`,w.id="calculator",w.style.float="left",w.style.backgroundSize="cover",w.style.backgroundPosition="center",w.style.width="20px",w.style.height="26px",w.style.border="none",w.style.marginTop="13px",w.style.cursor="pointer",w.style.backgroundColor="#4B4B4B",(!1===c||window.parent.location.href.startsWith("chrome-extension://"))&&(w.style.display="none");const f=document.createElement("button");f.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/symbol-icon.png")}`,f.id="symbolsheet",f.style.backgroundRepeat="no-repeat",f.style.backgroundPosition="center",f.style.backgroundSize="contain",f.style.width="20px",f.style.height="26px",f.style.border="none",f.style.cursor="pointer",f.style.marginTop="13px",f.addEventListener("click",e=>{chrome.runtime.sendMessage({action:"symbolsheet"})}),f.style.backgroundColor="#4B4B4B",window.parent.location.href.startsWith("chrome-extension://")&&(f.style.display="none");let x="URL";const v=document.createElement("span");v.addEventListener("click",()=>{v.textContent===n.link_blocked?v.textContent=x:v.style.display="none"}),v.id="blocked-url",v.style.zIndex="10",v.style.marginTop="0px",v.style.border="solid",v.style.borderRadius="6px",v.style.backgroundColor="#ebd2d5",v.textContent=n.link_blocked,v.style.color="#ae0015",v.style.marginLeft="15px",v.style.padding="3px 5px 3px 5px",v.style.lineHeight="40px",v.style.fontFamily="Arial",v.style.fontSize="medium",v.style.display="none",b.appendChild(v);const k=document.createElement("span");k.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/recording-icon.png")}`,k.id="recording-icon",k.style.float="left",k.style.backgroundSize="cover",k.style.backgroundPosition="center",k.style.width="60px",k.style.height="20px",k.style.border="none",k.style.borderRadius="6px",k.style.marginTop="17px",!1===y&&(k.style.display="none");const L=async e=>{const t=(await chrome.storage.local.get("systemState")).systemState,n=t.earlyExit,a=t.earlyExitReason,o=!(!t.proctorExitPassword&&!t.hasTestPassword),s=t.monitorTabId,i=t.susOpen,l=t.instructorLiveProctoring,c=t.lmsType;(n||a||o||c||s===r&&i||s===r&&l)&&chrome.runtime.sendMessage({action:"showearlyexit"})},T=document.createElement("button");T.addEventListener("click",L),T.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/x-square.png")}`,T.id="exit-button",T.style.backgroundSize="cover",T.style.backgroundPosition="center",T.style.width="30px",T.style.height="30px",T.style.borderRadius="5px",T.style.border="none",T.style.marginTop="12px",T.style.marginRight="10px",T.style.cursor="pointer";const E=document.createElement("div");E.style.width="1px",E.style.height="30px",E.style.backgroundColor="#AAAAAA",E.style.marginTop="13px",p.appendChild(g),p.appendChild(b),b.appendChild(k),b.appendChild(w),b.appendChild(f),b.appendChild(E),b.appendChild(T);const C=document.createElement("div");C.id="ldbtoolbar-shadow",document.body.appendChild(C);const _=C.attachShadow({mode:"open"});_.appendChild(p),chrome.runtime.onMessage.addListener((e,t,a)=>{if("newtab"===e.action&&l&&g.appendChild(h(e.newTabId,r,l,e.newTabTitle)),"removetab"===e.action&&document){const t=_.getElementById(e.tabId);t&&g.removeChild(t)}"blockedurlerror"===e.action&&(x=e.url,v.textContent=n.link_blocked,v.style.display=""),"recordingstarted"===e.action&&(k.style.display="block"),"recordingended"===e.action&&(k.style.display="none",r===d&&o&&(o.textContent="Post Exam")),"allowearlyexit"===e.action&&T.addEventListener("click",L),"allowcalculator"!==e.action||window.parent.location.href.startsWith("chrome-extension://")||(w.style.display="block"),"disableearlyexit"===e.action&&(T.removeEventListener("click",L),e.allowPassword&&T.addEventListener("click",L))})})}},5186:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.protectPage=void 0;t.protectPage=async(e,t,n,a,o=!0)=>{const r=(a=a||window)?a.document.body:document.body,s=o?"":"_standard";r.addEventListener("contextmenu",e=>{e.preventDefault()});const i=a===window.parent;var l=null,c=!1,d=!1;const y=()=>{m(),r.innerHTML="",g("The extension has been uninstalled which is not permitted."),setTimeout(()=>{a.location.href=a.origin},4e3)},m=()=>{const e=document.cookie.split(";");for(let t=0;t<e.length;t++){const n=e[t],a=n.indexOf("=");let o=a>-1?n.substr(0,a):n;document.cookie=o+="=;expires=Thu, 01 Jan  1970 00:00:00 GMT;path=/"}},p=async()=>{try{const t=await navigator.clipboard.read();t[0]&&t[0].types.includes("image/png")&&(await navigator.clipboard.writeText(" "),c=!0,e&&g(e.screenshot_warning),chrome.runtime.sendMessage("screenshotdetected",t=>{t.screenshotCount>1&&(d=!0,e&&g(e.screenshot_exit))}))}catch(e){}},u=async(e,t)=>{if(t&&a.location.href.includes(t)){if("granted"===(await navigator.permissions.query({name:"clipboard-write"})).state&&(await(async()=>{for(let e=1;e<15;e++)try{await new Promise(t=>{setTimeout(async()=>{await navigator.clipboard.writeText(" ".repeat(e)),t(null)},300)})}catch(e){}})(),e)){await navigator.permissions.query({name:"clipboard-read"})&&setInterval(p,3e3)}}},g=e=>{l&&l.remove(),(l=document.createElement("div")).style.backgroundColor="rgb(239, 239, 239)",l.style.position="fixed",l.style.width="100%",l.style.top="0",l.style.left="0",l.style.zIndex="3000",l.style.height="100%";const t=document.createElement("p");t.style.textAlign="left",t.style.position="absolute",t.style.top="200px",t.style.left="40px",t.style.fontFamily="verdana",t.style.fontSize="24px",t.style.wordWrap="break-word",t.style.whiteSpace="normal",t.style.color="black",t.style.lineHeight="1",e&&(t.innerHTML=e),l.appendChild(t),r.appendChild(l)},h=()=>{l&&!d&&(l.remove(),l=null)},b=(t,n,a)=>{"focuslost"===t.action&&e&&g(e[`focus_lost_warning${s}`]),"focuslostlimit"===t.action&&e&&(g(e[`focus_lost_exit${s}`]),d=!0),"displaychange"===t.action&&e&&(g(e.secondary_display_exit),d=!0),"protectpagesignalcheck"===t.action&&a("response")},w=t=>{"showoverlay"===t.data&&g(),"hideoverlay"===t.data&&h(),"showoverlay-ctrlalt"===t.data&&e&&g(e.ctrl_alt_shift_warning)};r.addEventListener("keydown",t=>{!t.ctrlKey||t.shiftKey||t.altKey||c||(i?g():window.parent.postMessage("showoverlay","*")),t.ctrlKey&&t.shiftKey&&(t.preventDefault(),c=!0,i&&e?g(e.ctrl_alt_shift_warning):window.parent.postMessage("showoverlay-ctrlalt","*")),t.ctrlKey&&t.altKey&&(t.preventDefault(),c=!0,i&&e?g(e.ctrl_alt_shift_warning):window.parent.postMessage("showoverlay-ctrlalt","*")),(t.ctrlKey||t.metaKey)&&"p"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"s"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"w"===t.key&&t.preventDefault(),!t.ctrlKey&&!t.metaKey||"h"!==t.key&&"j"!==t.key||t.preventDefault(),!t.ctrlKey&&!t.metaKey||"k"!==t.key&&"l"!==t.key||t.preventDefault(),!t.ctrlKey&&!t.metaKey||"t"!==t.key&&"n"!==t.key||t.preventDefault(),(t.ctrlKey||t.metaKey)&&"d"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"u"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"o"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"f"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"r"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"Tab"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&/^[1-9]$/.test(t.key)&&t.preventDefault(),"F12"===t.key&&t.preventDefault(),"Escape"===t.key&&(c=!1,i?h():window.parent.postMessage("hideoverlay","*"))}),r.addEventListener("keyup",e=>{"Control"!==e.key||c||c||(i?h():window.parent.postMessage("hideoverlay","*"))}),i&&(a.addEventListener("message",w),chrome.runtime.onMessage.addListener(b)),r.addEventListener("contextmenu",e=>{e.preventDefault()}),t&&u(i,n),setInterval(()=>{chrome.runtime.id||y()},5e3),history.pushState(null,"",location.href),a.onpopstate=()=>{history.go(1)}}},7125:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.postPatchListener=t.createBlankImage=t.filterExtensions=t.getTabTitle=t.getUrlObj=t.SHA256=t.extractPathId=t.isInjected=t.isIllegalTab=t.isValidUrl=t.getChromeVersion=t.extractSearchParams=t.notifyAllFrames=t.notifyAllTabs=t.getAllTabs=t.getActiveTab=t.parseParentheticalList=t.setOverrideLocale=t.getTranslation=t.getTranslations=t.geti18nTranslations=t.getGLobalServer=t.resetLaunchTab=t.combineTabsToWindow=t.containsDomainPattern=t.containsAllowedDomains=t.containsUrlPattern=t.getArrayFromUrlParam=t.getDomainUrlFromURL=t.extractXML=t.cleanHistory=t.cleanLDBHistory=t.removeLDBCookies=t.removeLMSCookies=t.setCookie=void 0;t.setCookie=async(e,t,n,a)=>{try{const o=new URL(t);["http:","https:"].includes(o.protocol)&&await chrome.cookies.set({name:e,url:o.origin,value:encodeURIComponent(n),domain:a})}catch(e){}};t.removeLMSCookies=async e=>{const t=new URL(e),n=await chrome.cookies.getAll({url:t.origin});for(const e of n)await chrome.cookies.remove({name:e.name,url:t.origin})};t.removeLDBCookies=async()=>{const e=["rldbcv","rldbacv","rldbrv","rldbarv","rldbswipe","rldbsc","rldbsi","rldbci","rldbdto","_MS","LDB"];for(const t of e){const e=await chrome.cookies.getAll({name:t});for(const t of e)await chrome.cookies.remove({name:t.name,url:`https://${t.domain}`})}};t.cleanLDBHistory=async(e,t)=>{if(e.includes(t)||e.includes(chrome.runtime.id))try{chrome.history.deleteUrl({url:e})}catch(e){}};t.cleanHistory=async e=>{await chrome.history.deleteRange({startTime:e,endTime:Date.now()})};t.extractXML=(e,t)=>{const n=new RegExp(`<${e}>(.*?)</${e}>`),a=t.match(n);return a?a[1]:null};t.getDomainUrlFromURL=e=>{try{return new URL(e).origin}catch(e){}return null};t.getArrayFromUrlParam=(e,t)=>{const n=new URL(e);var a=n.searchParams,o=n.hash.indexOf("?");0===a.size&&-1!==o&&(a=new URLSearchParams(n.hash.slice(o)));const r=a.get(t);return r&&r.startsWith("(")&&r.endsWith(")")?r.slice(1,-1).split(",").map(e=>e.trim()):[]};t.containsUrlPattern=(e,t)=>{for(const n of t){const t=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*");if(new RegExp(t).test(e))return!0}return!1};t.containsAllowedDomains=(e,t)=>{var n=!1;try{var a=new URL(e).host;let t=a.split(".");t.length>1&&(a=t.slice(-2).join("."))}catch(e){return!1}return t.forEach(e=>{e.split(".").length>1&&(e=e.split(".").splice(-2).join(".")),a==e&&(n=!0)}),n};t.containsDomainPattern=(e,t)=>{try{const n=new URL(e).hostname;for(const e of t){const t=e.replace(/\./g,"\\.").replace(/\*/g,".*");if(new RegExp(`^${t}$`).test(n))return!0}return!1}catch(e){return!1}};t.combineTabsToWindow=async e=>{const t=await chrome.windows.getLastFocused();for(const n of e)await chrome.tabs.move(n,{windowId:t.id,index:-1})};t.resetLaunchTab=async(e,t,n,a,o)=>{a&&t.includes(n)&&(a=o),a&&await chrome.tabs.update(e,{url:a,active:!1})};t.getGLobalServer=async()=>{const e=await chrome.runtime.sendMessage({action:"getGlobalServer"});try{return new URL(e.globalServer),e.globalServer}catch(e){return null}};t.geti18nTranslations=e=>{let t={};for(const n of e)t[n]=chrome.i18n.getMessage(n);return t};t.getTranslations=async(e,t)=>{const n="_locales/"+t+"/messages.json";try{const t=await(await fetch(chrome.runtime.getURL(n))).json();for(const n of Object.keys(e))e[n]=t[n].message}catch(e){}return e};t.getTranslation=async(e,t)=>{if(t){const n="_locales/"+t+"/messages.json";return(await(await fetch(chrome.runtime.getURL(n))).json())[e].message}return chrome.i18n.getMessage(e)};t.setOverrideLocale=async(e,t,n)=>{if(!1===t.includes(e))try{const t=new Intl.Locale(e.replace("_","-")).language;await n.set("overrideLocale",t)}catch(e){}else await n.set("overrideLocale",e)};t.parseParentheticalList=e=>(e&&(e=(e=e.replace(/[()]| /g,"")).toLowerCase()),e?e.split(","):[]);t.getActiveTab=async e=>(await chrome.tabs.query({active:!0,windowId:e}))[0];t.getAllTabs=async()=>await chrome.tabs.query({});t.notifyAllTabs=async e=>{const n=await(0,t.getAllTabs)();for(const t of n)t.id&&chrome.tabs.sendMessage(t.id,e)};t.notifyAllFrames=async(e,t,n)=>{const a=await chrome.webNavigation.getAllFrames({tabId:e});if(a)for(const o of a)if(o.frameId!==n)try{await chrome.tabs.sendMessage(e,t,{frameId:o.frameId})}catch(e){}};t.extractSearchParams=e=>{const t=new URL(e);var n=t.searchParams,a=t.hash.indexOf("?");return 0===n.size&&-1!==a&&(n=new URLSearchParams(t.hash.slice(a))),n};t.getChromeVersion=()=>{try{const e=navigator.userAgent.match(/Chrome\/([\d.]+)/)?.[1];if(e)return parseFloat(e)}catch(e){}return null};t.isValidUrl=e=>{try{const t=new URL(e);if(!0===["http:","https:"].includes(t.protocol))return!0}catch(e){}return!1};t.isIllegalTab=(e,t,n)=>!(!e.id||!e.url||e.url.includes(chrome.runtime.id)||e.openerTabId&&n.includes(e.openerTabId)||!t||e.id===t||n.includes(e.id)&&!e.url.includes("ws.readspeaker.com"));t.isInjected=async(e,t,n)=>await new Promise(a=>{void 0!==n?chrome.tabs.sendMessage(e,{action:t},{frameId:n},e=>{chrome.runtime.lastError?a(!1):a(!0)}):chrome.tabs.sendMessage(e,{action:t},e=>{chrome.runtime.lastError?a(!1):a(!0)})});t.extractPathId=(e,t)=>{const n=new RegExp(`/${t}/(\\d+)(?=/|\\?|$)`),a=e.match(n);if(a)return a[1]};t.SHA256=async e=>{const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")};t.getUrlObj=e=>{try{return new URL(e)}catch(e){}};t.getTabTitle=e=>"canvasclassic"===e||"canvasnew"===e?"Canvas":"moodle"===e?"Moodle":"blackboardog"===e||"blackboardultra"===e?"Blackboard":"d2l"===e?"Brightspace":"infinitecampus"===e?"Infinite":"schoology"===e?"Schoology":void 0;t.filterExtensions=(e,t,n,a)=>{const o=[];for(const r of e){const e=!t.some(e=>e.includes(r.id)),s=!n.some(e=>r.name.toLowerCase().includes(e.toLowerCase())),i=a.some(e=>e===r.id);e&&(s||i||"development"===r.installType)&&o.push(r)}return o};t.createBlankImage=async(e=1920,t=1080)=>{try{const n=new OffscreenCanvas(e,t),a=n.getContext("2d");a&&(a.fillStyle="#000000",a.fillRect(0,0,e,t));const o=await n.convertToBlob({type:"image/png"});return await o.arrayBuffer()}catch(e){return null}};t.postPatchListener=e=>{const t=window.XMLHttpRequest,n=function(){const n=new t;let a,o,r=null;const s=n.open;n.open=function(e,t,r=!0,i,l){return a=e?e.toUpperCase():e,o=t,s.call(n,e,t,r,i??null,l??null)};const i=n.send;return n.send=function(t){return"POST"!==a&&"PATCH"!==a||"string"!=typeof t||(r=t,e(o.toString(),r)),i.call(n,t??null)},n};n.prototype=t.prototype,n.UNSENT=t.UNSENT,n.OPENED=t.OPENED,n.HEADERS_RECEIVED=t.HEADERS_RECEIVED,n.LOADING=t.LOADING,n.DONE=t.DONE,window.XMLHttpRequest=n}}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}(()=>{const e=n(7125),t=n(5186),a=n(3982),o=n(2530);chrome.storage.local.get("systemState",async n=>{let o=(0,e.geti18nTranslations)(["screenshot_warning","screenshot_exit","focus_lost_warning"+(n.systemState.lmsType?"":"_standard"),"focus_lost_exit"+(n.systemState.lmsType?"":"_standard"),"ctrl_alt_shift_warning","secondary_display_exit","dev_tool_exit","continue_to_exit","continue"]);n.systemState.overrideLocale&&(o=await(0,e.getTranslations)(o,n.systemState.overrideLocale)),(0,t.protectPage)(o,!1,n.systemState.lmsUrl,null,!!n.systemState.lmsType),(0,a.createToolbar)()}),chrome.runtime.onMessage.addListener((e,t,n)=>{"createearlyexit"===e.action&&(0,o.createEarlyExit)()})})()})();