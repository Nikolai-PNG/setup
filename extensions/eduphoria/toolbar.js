(()=>{"use strict";var e={3982:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createToolbar=void 0;const o=n(7125);t.createToolbar=()=>{chrome.runtime.onMessage.addListener((e,t,n)=>{"toolbarsignalcheck"==e.action&&n("")}),chrome.storage.local.get("systemState",async e=>{const t=e.systemState;let n=(0,o.geti18nTranslations)(["exit_confirm","yes","no","proctor_password","enter","dismiss","incorrect_password","calculator","exam_link","link_blocked"]);var r;t.overrideLocale&&(n=await(0,o.getTranslations)(n,t.overrideLocale));const a=await chrome.runtime.sendMessage("gettabid"),s=t.examTabTitle,i=t.tabIds,l=t.examTabId,c=t.calculator>0,d=t.monitorTabId,m=t.recordingStarted,y=t.susOpen,g=document.createElement("div"),p="54px";g.id="ldbtoolbar",g.style.width="100%",g.style.backgroundColor="#4B4B4B",g.style.height=p,g.style.maxHeight=p,g.style.position="fixed",g.style.left="0px",g.style.top="0px",g.style.zIndex="9999999",g.style.display="flex";const u=document.createElement("ul");u.id="tablist",u.style.listStyleType="none",u.style.overflow="hidden",u.style.margin="0",u.style.padding="0";const h=(e,t,o,a,s)=>{const i=document.createElement("li");i.addEventListener("click",t=>{const n=t.currentTarget;"exit-tab"===t.target.id?chrome.runtime.sendMessage({action:"removetab",tabId:e}):n.id===e.toString()&&chrome.runtime.sendMessage({action:"activatetab",tabId:e})}),e?i.id=e.toString():chrome.runtime.sendMessage({action:"getTabId"},e=>{e.tabId&&(i.id=e.tabId)}),i.style.minWidth="175px",i.style.float="left",i.style.height="51px",i.style.textAlign="left",t===e?(i.style.backgroundColor="white",i.style.color="#4a4a4a"):(i.style.cursor="pointer",i.style.color="white"),t===o&&i.classList.add("exam-tab"),i.style.fontFamily="Arial",i.style.fontSize="medium",i.style.border="solid",i.style.borderColor="gray",i.style.borderWidth="1px",i.style.lineHeight="52px",i.style.userSelect="none";const l=document.createElement("span");t===s&&(r=l),l.id="tab-title",a?l.textContent=a:e===o?l.textContent="Exam":e===t&&location.ancestorOrigins[0]&&location.ancestorOrigins[0].includes("smc-service-cloud.respondus2.com")?l.textContent="Troubleshooter":e===t&&location.ancestorOrigins[0]&&location.ancestorOrigins[0].includes("respondus.knowledgeowl.com")?l.textContent="Knowledge Base":e===t&&window.location.origin.includes("paypal")?l.textContent="PayPal":l.textContent=n.exam_link,l.style.paddingLeft="16px",l.style.paddingRight="16px",i.appendChild(l);const c=document.createElement("button");return c.id="exit-tab",c.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/close-tab.png")}`,c.style.height="15px",c.style.float="right",c.style.marginTop="18px",c.style.marginRight="20px",c.style.marginLeft="10px",c.style.width="20px",c.style.backgroundColor="#4B4B4B",c.style.backgroundSize="cover",c.style.border="none",c.style.borderRadius="3px",c.style.cursor="pointer",o!==e&&i.appendChild(c),i};if((y||t.instructorLiveProctoring)&&d===a){let e="Pre Exam Checks";t.instructorLiveProctoring&&(e="Live Proctoring"),u.append(h(d,a,d,e,d))}else l&&u.append(h(l,a,l,s));if(i&&l)for(const e of i)u.appendChild(h(e,a,l));const b=document.createElement("div");b.style.position="absolute",b.style.right="0",b.style.display="flex",b.style.gap="26px",b.style.backgroundColor="#4B4B4B",b.style.height="54px",b.style.paddingLeft="5px";const w=document.createElement("button");w.addEventListener("click",e=>{chrome.runtime.sendMessage({action:"calculator"})}),w.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/calculator-light.png")}`,w.id="calculator",w.style.float="left",w.style.backgroundSize="cover",w.style.backgroundPosition="center",w.style.width="20px",w.style.height="26px",w.style.border="none",w.style.marginTop="13px",w.style.cursor="pointer",w.style.backgroundColor="#4B4B4B",(!1===c||window.parent.location.href.startsWith("chrome-extension://"))&&(w.style.display="none");const x=document.createElement("button");x.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/symbol-icon.png")}`,x.id="symbolsheet",x.style.backgroundRepeat="no-repeat",x.style.backgroundPosition="center",x.style.backgroundSize="contain",x.style.width="20px",x.style.height="26px",x.style.border="none",x.style.cursor="pointer",x.style.marginTop="13px",x.addEventListener("click",e=>{chrome.runtime.sendMessage({action:"symbolsheet"})}),x.style.backgroundColor="#4B4B4B",window.parent.location.href.startsWith("chrome-extension://")&&(x.style.display="none");let f="URL";const v=document.createElement("span");v.addEventListener("click",()=>{v.textContent===n.link_blocked?v.textContent=f:v.style.display="none"}),v.id="blocked-url",v.style.zIndex="10",v.style.marginTop="0px",v.style.border="solid",v.style.borderRadius="6px",v.style.backgroundColor="#ebd2d5",v.textContent=n.link_blocked,v.style.color="#ae0015",v.style.marginLeft="15px",v.style.padding="3px 5px 3px 5px",v.style.lineHeight="40px",v.style.fontFamily="Arial",v.style.fontSize="medium",v.style.display="none",b.appendChild(v);const L=document.createElement("span");L.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/recording-icon.png")}`,L.id="recording-icon",L.style.float="left",L.style.backgroundSize="cover",L.style.backgroundPosition="center",L.style.width="60px",L.style.height="20px",L.style.border="none",L.style.borderRadius="6px",L.style.marginTop="17px",!1===m&&(L.style.display="none");const k=async e=>{const t=(await chrome.storage.local.get("systemState")).systemState,n=t.earlyExit,o=t.earlyExitReason,r=!(!t.proctorExitPassword&&!t.hasTestPassword),s=t.monitorTabId,i=t.susOpen,l=t.instructorLiveProctoring,c=t.lmsType;(n||o||r||c||s===a&&i||s===a&&l)&&chrome.runtime.sendMessage({action:"showearlyexit"})},T=document.createElement("button");T.addEventListener("click",k),T.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/x-square.png")}`,T.id="exit-button",T.style.backgroundSize="cover",T.style.backgroundPosition="center",T.style.width="30px",T.style.height="30px",T.style.borderRadius="5px",T.style.border="none",T.style.marginTop="12px",T.style.marginRight="10px",T.style.cursor="pointer";const C=document.createElement("div");C.style.width="1px",C.style.height="30px",C.style.backgroundColor="#AAAAAA",C.style.marginTop="13px",g.appendChild(u),g.appendChild(b),b.appendChild(L),b.appendChild(w),b.appendChild(x),b.appendChild(C),b.appendChild(T);const E=document.createElement("div");E.id="ldbtoolbar-shadow",document.body.appendChild(E);const R=E.attachShadow({mode:"open"});R.appendChild(g),chrome.runtime.onMessage.addListener((e,t,o)=>{if("newtab"===e.action&&l&&u.appendChild(h(e.newTabId,a,l,e.newTabTitle)),"removetab"===e.action&&document){const t=R.getElementById(e.tabId);t&&u.removeChild(t)}"blockedurlerror"===e.action&&(f=e.url,v.textContent=n.link_blocked,v.style.display=""),"recordingstarted"===e.action&&(L.style.display="block"),"recordingended"===e.action&&(L.style.display="none",a===d&&r&&(r.textContent="Post Exam")),"allowearlyexit"===e.action&&T.addEventListener("click",k),"allowcalculator"!==e.action||window.parent.location.href.startsWith("chrome-extension://")||(w.style.display="block"),"disableearlyexit"===e.action&&(T.removeEventListener("click",k),e.allowPassword&&T.addEventListener("click",k))})})}},7125:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.postPatchListener=t.createBlankImage=t.filterExtensions=t.getTabTitle=t.getUrlObj=t.SHA256=t.extractPathId=t.isInjected=t.isIllegalTab=t.isValidUrl=t.getChromeVersion=t.extractSearchParams=t.notifyAllFrames=t.notifyAllTabs=t.getAllTabs=t.getActiveTab=t.parseParentheticalList=t.setOverrideLocale=t.getTranslation=t.getTranslations=t.geti18nTranslations=t.getGLobalServer=t.resetLaunchTab=t.combineTabsToWindow=t.containsDomainPattern=t.containsAllowedDomains=t.containsUrlPattern=t.getArrayFromUrlParam=t.getDomainUrlFromURL=t.extractXML=t.cleanHistory=t.cleanLDBHistory=t.removeLDBCookies=t.removeLMSCookies=t.setCookie=void 0;t.setCookie=async(e,t,n,o)=>{try{const r=new URL(t);["http:","https:"].includes(r.protocol)&&await chrome.cookies.set({name:e,url:r.origin,value:encodeURIComponent(n),domain:o})}catch(e){}};t.removeLMSCookies=async e=>{const t=new URL(e),n=await chrome.cookies.getAll({url:t.origin});for(const e of n)await chrome.cookies.remove({name:e.name,url:t.origin})};t.removeLDBCookies=async()=>{const e=["rldbcv","rldbacv","rldbrv","rldbarv","rldbswipe","rldbsc","rldbsi","rldbci","rldbdto","_MS","LDB"];for(const t of e){const e=await chrome.cookies.getAll({name:t});for(const t of e)await chrome.cookies.remove({name:t.name,url:`https://${t.domain}`})}};t.cleanLDBHistory=async(e,t)=>{if(e.includes(t)||e.includes(chrome.runtime.id))try{chrome.history.deleteUrl({url:e})}catch(e){}};t.cleanHistory=async e=>{await chrome.history.deleteRange({startTime:e,endTime:Date.now()})};t.extractXML=(e,t)=>{const n=new RegExp(`<${e}>(.*?)</${e}>`),o=t.match(n);return o?o[1]:null};t.getDomainUrlFromURL=e=>{try{return new URL(e).origin}catch(e){}return null};t.getArrayFromUrlParam=(e,t)=>{const n=new URL(e);var o=n.searchParams,r=n.hash.indexOf("?");0===o.size&&-1!==r&&(o=new URLSearchParams(n.hash.slice(r)));const a=o.get(t);return a&&a.startsWith("(")&&a.endsWith(")")?a.slice(1,-1).split(",").map(e=>e.trim()):[]};t.containsUrlPattern=(e,t)=>{for(const n of t){const t=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*");if(new RegExp(t).test(e))return!0}return!1};t.containsAllowedDomains=(e,t)=>{var n=!1;try{var o=new URL(e).host;let t=o.split(".");t.length>1&&(o=t.slice(-2).join("."))}catch(e){return!1}return t.forEach(e=>{e.split(".").length>1&&(e=e.split(".").splice(-2).join(".")),o==e&&(n=!0)}),n};t.containsDomainPattern=(e,t)=>{try{const n=new URL(e).hostname;for(const e of t){const t=e.replace(/\./g,"\\.").replace(/\*/g,".*");if(new RegExp(`^${t}$`).test(n))return!0}return!1}catch(e){return!1}};t.combineTabsToWindow=async e=>{const t=await chrome.windows.getLastFocused();for(const n of e)await chrome.tabs.move(n,{windowId:t.id,index:-1})};t.resetLaunchTab=async(e,t,n,o,r)=>{o&&t.includes(n)&&(o=r),o&&await chrome.tabs.update(e,{url:o,active:!1})};t.getGLobalServer=async()=>{const e=await chrome.runtime.sendMessage({action:"getGlobalServer"});try{return new URL(e.globalServer),e.globalServer}catch(e){return null}};t.geti18nTranslations=e=>{let t={};for(const n of e)t[n]=chrome.i18n.getMessage(n);return t};t.getTranslations=async(e,t)=>{const n="_locales/"+t+"/messages.json";try{const t=await(await fetch(chrome.runtime.getURL(n))).json();for(const n of Object.keys(e))e[n]=t[n].message}catch(e){}return e};t.getTranslation=async(e,t)=>{if(t){const n="_locales/"+t+"/messages.json";return(await(await fetch(chrome.runtime.getURL(n))).json())[e].message}return chrome.i18n.getMessage(e)};t.setOverrideLocale=async(e,t,n)=>{if(!1===t.includes(e))try{const t=new Intl.Locale(e.replace("_","-")).language;await n.set("overrideLocale",t)}catch(e){}else await n.set("overrideLocale",e)};t.parseParentheticalList=e=>(e&&(e=(e=e.replace(/[()]| /g,"")).toLowerCase()),e?e.split(","):[]);t.getActiveTab=async e=>(await chrome.tabs.query({active:!0,windowId:e}))[0];t.getAllTabs=async()=>await chrome.tabs.query({});t.notifyAllTabs=async e=>{const n=await(0,t.getAllTabs)();for(const t of n)t.id&&chrome.tabs.sendMessage(t.id,e)};t.notifyAllFrames=async(e,t,n)=>{const o=await chrome.webNavigation.getAllFrames({tabId:e});if(o)for(const r of o)if(r.frameId!==n)try{await chrome.tabs.sendMessage(e,t,{frameId:r.frameId})}catch(e){}};t.extractSearchParams=e=>{const t=new URL(e);var n=t.searchParams,o=t.hash.indexOf("?");return 0===n.size&&-1!==o&&(n=new URLSearchParams(t.hash.slice(o))),n};t.getChromeVersion=()=>{try{const e=navigator.userAgent.match(/Chrome\/([\d.]+)/)?.[1];if(e)return parseFloat(e)}catch(e){}return null};t.isValidUrl=e=>{try{const t=new URL(e);if(!0===["http:","https:"].includes(t.protocol))return!0}catch(e){}return!1};t.isIllegalTab=(e,t,n)=>!(!e.id||!e.url||e.url.includes(chrome.runtime.id)||e.openerTabId&&n.includes(e.openerTabId)||!t||e.id===t||n.includes(e.id)&&!e.url.includes("ws.readspeaker.com"));t.isInjected=async(e,t,n)=>await new Promise(o=>{void 0!==n?chrome.tabs.sendMessage(e,{action:t},{frameId:n},e=>{chrome.runtime.lastError?o(!1):o(!0)}):chrome.tabs.sendMessage(e,{action:t},e=>{chrome.runtime.lastError?o(!1):o(!0)})});t.extractPathId=(e,t)=>{const n=new RegExp(`/${t}/(\\d+)(?=/|\\?|$)`),o=e.match(n);if(o)return o[1]};t.SHA256=async e=>{const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")};t.getUrlObj=e=>{try{return new URL(e)}catch(e){}};t.getTabTitle=e=>"canvasclassic"===e||"canvasnew"===e?"Canvas":"moodle"===e?"Moodle":"blackboardog"===e||"blackboardultra"===e?"Blackboard":"d2l"===e?"Brightspace":"infinitecampus"===e?"Infinite":"schoology"===e?"Schoology":void 0;t.filterExtensions=(e,t,n,o)=>{const r=[];for(const a of e){const e=!t.some(e=>e.includes(a.id)),s=!n.some(e=>a.name.toLowerCase().includes(e.toLowerCase())),i=o.some(e=>e===a.id);e&&(s||i||"development"===a.installType)&&r.push(a)}return r};t.createBlankImage=async(e=1920,t=1080)=>{try{const n=new OffscreenCanvas(e,t),o=n.getContext("2d");o&&(o.fillStyle="#000000",o.fillRect(0,0,e,t));const r=await n.convertToBlob({type:"image/png"});return await r.arrayBuffer()}catch(e){return null}};t.postPatchListener=e=>{const t=window.XMLHttpRequest,n=function(){const n=new t;let o,r,a=null;const s=n.open;n.open=function(e,t,a=!0,i,l){return o=e?e.toUpperCase():e,r=t,s.call(n,e,t,a,i??null,l??null)};const i=n.send;return n.send=function(t){return"POST"!==o&&"PATCH"!==o||"string"!=typeof t||(a=t,e(r.toString(),a)),i.call(n,t??null)},n};n.prototype=t.prototype,n.UNSENT=t.UNSENT,n.OPENED=t.OPENED,n.HEADERS_RECEIVED=t.HEADERS_RECEIVED,n.LOADING=t.LOADING,n.DONE=t.DONE,window.XMLHttpRequest=n}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}(0,n(3982).createToolbar)()})();